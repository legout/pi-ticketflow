---
id: pt-0v53
status: closed
deps: [pt-6d99]
links: [pt-6d99, pt-9yjn]
created: 2026-02-13T16:05:22Z
type: task
priority: 2
assignee: legout
external-ref: seed-add-ralph-loop-background-interactive
tags: [tf, backlog, component:cli, component:workflow]
---
# Add per-ticket worktree lifecycle for dispatch runs

## Task
Create worktrees on ticket start, run dispatch inside them, then merge and close worktrees on ticket close.

## Context
Design decision: worktrees are created on-the-fly per ticket and cleaned up as part of close flow.
This keeps parallel runs isolated while preserving current merge semantics.

## Acceptance Criteria
- [ ] Worktree is created before dispatch starts for a ticket.
- [ ] Dispatch runner executes with worktree as cwd.
- [ ] Success path merges and closes worktree; failure path performs safe cleanup.

## Constraints
- Maintain compatibility with existing Ralph worktree options.

## References
- Seed: seed-add-ralph-loop-background-interactive
- Plan: plan-ralph-background-interactive-shell
- Spike: spike-interactive-shell-execution


## Notes

**2026-02-13T21:31:48Z**

Implemented per-ticket worktree lifecycle for dispatch runs. Adds create_worktree_for_ticket(), merge_and_close_worktree(), and cleanup_worktree() functions. Integrates into Ralph serial mode for dispatch backend. Merge failure now properly marks ticket as FAILED. Commit: 3147475
