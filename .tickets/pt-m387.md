---
id: pt-m387
status: closed
deps: [pt-4y31]
links: [pt-4y31, pt-za25]
created: 2026-02-09T13:26:39Z
type: task
priority: 2
assignee: legout
external-ref: spike-datastar-py-sanic-datastar-tf-web-ui
tags: [tf, backlog, component:api, component:cli, component:config, component:workflow]
---
# Add /api/stream SSE endpoint (Sanic) for live board updates

## Task
Add a Sanic SSE streaming endpoint using datastar-py’s Sanic helpers so the board can be updated server-push style.

## Context
In Sanic, long-lived SSE streams are typically implemented via `resp = await datastar_respond(request)` followed by `await resp.send(...)` in a loop. datastar-py provides helpers for this pattern.

## Acceptance Criteria
- [ ] New endpoint exists (e.g. `GET /api/stream`) that streams `patch_elements` events periodically.
- [ ] Client subscribes on page load (e.g. `data-init="@get('/api/stream')"` on a stable element).
- [ ] Stream handles client disconnects without crashing the server (basic cancellation/cleanup).

## Constraints
- Keep update frequency conservative (e.g. 1–2s) to avoid busy loops.

## References
- Spike: spike-datastar-py-sanic-datastar-tf-web-ui



## Notes

**2026-02-09T14:30:03Z**

Implemented /api/stream SSE endpoint for live board updates.

Changes:
- Added datastar-py imports and DATASTAR_AVAILABLE flag for graceful degradation
- Implemented /api/stream endpoint with 2-second update interval
- Added client disconnect handling via asyncio.CancelledError
- Added data-init attribute to index.html for automatic subscription

Review: 0 Critical, 0 Major, 2 Minor issues (cosmetic, not fixed)
Commit: f3611f8
